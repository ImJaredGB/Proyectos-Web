<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css?family=Inter:400,700&display=swap" rel="stylesheet">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendario</title>
</head>

<body>
    
    <!--Navigation bar-->
    <div class="header">
        <nav>
            <ul>
                <li><a href="calendario.html">Calendario</a></li>
                <li><a href="habitaciones.html">Habitaciones</a></li>
                <li><a href="usuarios.html" class="active">Usuarios</a></li>
            </ul>
        </nav>
    </div>

    
    <!--Main content area-->
    <div class="main-content">


        <!--Data table-->
        <div id="tabla-habitaciones">
            <table class="tabla-habitaciones">
                <thead>
                    <tr>
                        <th>Nombres</th>
                        <th>Apellidos</th>
                        <th>Numero de documento</th>
                        <th>Llegada</th>
                        <th>Salida</th>
                        <th>Info. Adicional</th>
                        <th>Estado</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Las filas se generarán dinámicamente con JavaScript -->
            </table>
        </div>

        <!--Tool Sidebar-->
        <div class="tool-sidebar">
            <ul>
                <li><button>Agregar usuario</button></li>
                <li><button>Editar usuario</button></li>
            </ul>
        </div>
    </div>

    <!-- Modal para ver info de usuario -->
    <div id="modal-info" class="modal-info" style="display:none;">
        <div class="modal-content">
            <button id="close-modal" class="close-modal-btn">✕</button>
            <h2>Información del usuario</h2>
            <div id="modal-data"></div>
            <div id="modal-qr" style="margin: 20px 0;"></div>
            <button class="send-email-btn">Enviar al correo</button>
        </div>
    </div>

    <!--Animations and functions-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script>
        const usuariosHabitacion = [
            // Castillo
            { habitacion: "C101", litera: 1, nombre: "Juan", apellido: "Pérez", documento: "12345678", llegada: "2025-07-01", salida: "2025-08-10", estado: true, zona: "Castillo" },
            { habitacion: "C101", litera: 2, nombre: "Ana", apellido: "García", documento: "87654321", llegada: "2025-07-05", salida: "2025-07-25", estado: true, zona: "Castillo" },
            { habitacion: "C102", litera: 1, nombre: "Mario", apellido: "Torres", documento: "22334455", llegada: "2025-06-28", salida: "2025-07-15", estado: true, zona: "Castillo" },
            { habitacion: "C103", litera: 3, nombre: "Lucía", apellido: "Mendoza", documento: "33445566", llegada: "2025-07-20", salida: "2025-09-02", estado: true, zona: "Castillo" },

            // Restaurante
            { habitacion: "R101", litera: 1, nombre: "Pedro", apellido: "López", documento: "44556677", llegada: "2025-07-10", salida: "2025-08-01", estado: false, zona: "Restaurante" },
            { habitacion: "R102", litera: 2, nombre: "Carla", apellido: "Suárez", documento: "55667788", llegada: "2025-07-15", salida: "2025-07-30", estado: true, zona: "Restaurante" },
            { habitacion: "R103", litera: 1, nombre: "Esteban", apellido: "Vega", documento: "66778899", llegada: "2025-07-25", salida: "2025-08-15", estado: true, zona: "Restaurante" },

            // Piso
            { habitacion: "P101", litera: 1, nombre: "Marta", apellido: "Ríos", documento: "77889900", llegada: "2025-07-03", salida: "2025-07-20", estado: true, zona: "Piso" },
            { habitacion: "P102", litera: 2, nombre: "Sergio", apellido: "Castro", documento: "88990011", llegada: "2025-07-28", salida: "2025-08-05", estado: true, zona: "Piso" },
            
            // Vilanova
            { habitacion: "V101", litera: 1, nombre: "Paula", apellido: "Navarro", documento: "99001122", llegada: "2025-07-01", salida: "2025-09-01", estado: true, zona: "Vilanova" },
            { habitacion: "V102", litera: 2, nombre: "Javier", apellido: "Ortega", documento: "10111213", llegada: "2025-07-18", salida: "2025-08-10", estado: true, zona: "Vilanova" }
        ];

        function renderTablaUsuarios() {
            const tabla = document.querySelector("#tabla-habitaciones tbody");
            tabla.innerHTML = "";

            usuariosHabitacion.forEach((usuario, idx) => {
                const fila = document.createElement("tr");
                fila.innerHTML = `
                    <td>${usuario.nombre}</td>
                    <td>${usuario.apellido}</td>
                    <td>${usuario.documento}</td>
                    <td>${usuario.llegada}</td>
                    <td>${usuario.salida}</td>
                    <td>
                        <button class="info-btn" data-idx="${idx}">Ver info</button>
                    </td>
                    <td>${usuario.estado ? 'Activo' : 'Inactivo'}</td>
                `;
                tabla.appendChild(fila);
            });

            // Evento para mostrar modal
            document.querySelectorAll('.info-btn').forEach(btn => {
                btn.onclick = function() {
                    const idx = this.getAttribute('data-idx');
                    const usuario = usuariosHabitacion[idx];
                    mostrarModalInfo(usuario);
                };
            });
        }

        // Modal logic
        function mostrarModalInfo(usuario) {
            const modal = document.getElementById('modal-info');
            const modalData = document.getElementById('modal-data');
            const modalQR = document.getElementById('modal-qr');
            modal.style.display = 'flex';

            modalData.innerHTML = `
                <div style="margin-bottom:16px;">
                    <strong>Zona:</strong> ${usuario.zona}<br>
                    <strong>Habitación:</strong> ${usuario.habitacion}<br>
                    <strong>Litera:</strong> ${usuario.habitacion}_${usuario.litera}<br>
                </div>
            `;

            modalQR.innerHTML = "";
            // Info para QR
            const qrInfo = `
                Documento: ${usuario.documento}
            `;
            new QRCode(modalQR, {
                text: qrInfo,
                width: 160,
                height: 160,
                colorDark : "#1D1D1D",
                colorLight : "#fff",
                correctLevel : QRCode.CorrectLevel.L
            });
        }

        // Cerrar modal
        document.getElementById('close-modal').onclick = function() {
            document.getElementById('modal-info').style.display = 'none';
        };

        // Inicializar la tabla al cargar la página
        document.addEventListener("DOMContentLoaded", renderTablaUsuarios);

    </script>
</body>
</html>